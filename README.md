# GINClus: RNA Structural Motif Clustering Using Graph Isomorphism Network


## Install Instructions 
GINClus source code is implemented using Python 3.8.10 and can be executed in 64-bit Linux machine. The implementation can be divided into three major parts. (i) For the given motif locations, generating the graph representations for those motifs (ii) Generating motif subclusters based on their structural (base interaction and 3D structure) similarity (iii) For each subcluster, generating 3D diagrams of motifs side by side (This step is optional and can take comparatively longer to run)


#### Install python3:
```
Debian/Ubuntu: apt install python3.8  
Fedora/CentOS: dnf install python3.8 
```
#### Install pip3: 
```
Debian/Ubuntu: apt install python3-pip  
Fedora/CentOS: dnf install python3-pip  
```
#### Install required Python libraries:  
It is required to install several python libraries to run RNA-NRD pipeline. These libraries are included in the [requirements.txt](requirements.txt) file. To install all required python libraries, please navigate to the RNA-NRD home directory in the terminal and execute the following command.
```
pip3 install -r requirements.txt
```

#### Python packages that should already exist:  
os, sys, shutil, math, random, subprocess, glob, time, argparse, logging, requests  
  
*** If any of the above mentioned package doesn't exist, then please install with command 'pip3 install package-name' ***

## Run Instructions
    
  
**_Run command:_** python3 Run.py [-i 'Data.txt'] [-o1 'RNA-NRD_Dataset'] [-o2 'RNA-NRD_without_Organism_Division_Dataset'] [-t 80] [-r 4] [-a 80] [-org True]  
**_Help command:_** python3 Run.py -h  
**_Optional arguments:_** 
```
  -h, --help  	show this help message and exit  
  -it [IT]    	Path to the graph data generated for training motifs. Default:'graphs_dir/Train_Graph_Data/'.  
  -il [IL]    	Path to the graph data generated for unknown internal loop (IL) motifs. Default:'graphs_dir/IL_Graph_Data/'.  
  -o [O]      	Path to the output files. Default: 'output/'.  
  -t [T]      	Trains the model if t = True, else uses the previously trained model weight if t = False. Default: 'True'.  
  -idx [IDX]  	Training data permutation. To use random data permutation, use '1'. To use data permutation used in the published research paper, use '0'. Default: '0'. 
  -w [W]      	Parameter to save the model weight. Use '1' to save the new model weight. Otherwise, use '0'. Default: '1'.  
  -val [VAL]  	Sets the number '1-val' as the percentage of data that should be considered as validation data while training the model. Default: '0.873'.
  -test [TEST]	Sets the number '1-test' as the percentage of data that should be considered as test data while training the model. Default: '0.937'.
  -f [F]	Generates features for unknown motifs if f = True, else uses the previously generated features if f = False. Default: 'True'.
  -c [C]	Generates cluster output if t = True, else uses the previously generated clustering output if t = False. Default: 'True'.
  -k [K]	Define the number of clusters (value of K) to be generated. Default: 400.
  -tf [TF]	If tf = 1, takes RNA motif family information (family name and nname prefix) for train data from a file named 'Train_family_info.csv' inside 'data' folder. Otherwise uses the existing family information for training. Default: '0'.
  -uf [UF]	This parameter is useful if there are some known family motifs in the unknown motif family folder. If uf = 1, takes RNA motif family information (family name and name prefix) for unknown motif data from a file named 'Unknown_motif_family_info.csv' inside 'data' folder. If all the motifs have unknown family, then use uf = 2. Otherwise, uses the existing family information for unknown motif data. Default: '0'.
	  
```

**_Output:_** Generates the following output files inside the user defined output folder, default:'output' 
1. Motif_Features_IL.tsv: contains the feature set generated for each motif. These features are used to cluster the RNA motifs.
2. Cluster_output.csv: contains the clustering output of RNA motifs generated by K-means clustering algorithm.
3. Subcluster_output: contains the subclustering output of RNA motifs generated by Hierachical Agglomerative clustering algorithm.
4. subcluster_images: contans the images generated for each subcluster. A subcluster image contains the 3D diagrams of motifs side-by-side that belong to the subcluster.



           
### Important Notes
*** The PDB files 6EK0 and 4P95 have recently become obsolette and have been removed from the motif location input file 'IL_cluster_input.csv'.
*** Generating images for all the subclusters is optional and takes comparatively longer time generate all the images.

### Terms  
Where appropriate, please cite the following GINClus paper:  
Nabila et al. "GINClus: RNA Structural Motif Clustering Using Graph Isomorphism Network." 

### Contact
For any questions, please contact nabilakhan@knights.ucf.edu
